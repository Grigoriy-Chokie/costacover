{% style %}
  #shopify-section-{{ section.id }} {
    --product-list-button-color: {{ section.settings.button_color }};
  }
{% endstyle %}

{% capture slider_settings %}
	{
		"slidesPerView": 1.15,
    "spaceBetween": 10,
		"speed": 500
	}
{% endcapture  %}

<div class="product-list__container">
  <div class="product-list__heading-wrapper">
    {% unless section.settings.heading == blank %}
      <h2 class="product-list__heading">{{ section.settings.heading }}</h2>
    {% endunless %}


    {% unless section.settings.link_text == blank %}
      <a href="{{ section.settings.link_url }}" class="product-list__button">{{ section.settings.link_text }}</a>
    {% endunless %}
  </div>

  {%- if section.blocks.size > 0 -%}
    <div class="swiper product-list__swiper" {% render 'slider-attribute', config: slider_settings, is_mobile_only: section.settings.swiper_only_mobile %}>
      <div class="swiper-wrapper product-list__swiper-wrapper {% if section.settings.swiper_only_mobile %}product-list--swiper-mobile{% endif %}">
        {%- for block in section.blocks -%}
          {% render 'product-card', 
            product: block.settings.product, 
            hide_description: section.settings.hide_product_description, 
            class: 'swiper-slide product-list__slide' %}
        {%- endfor -%}
      </div>
    </div>
  {%- endif -%}
</div>

{% schema %}
{
  "name": "Product list",
  "tag": "section",
  "class": "product-list",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "text",
      "id": "link_text",
      "label": "Button text"
    },
    {
      "type": "url",
      "id": "link_url",
      "label": "Button url"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "checkbox",
      "id": "swiper_only_mobile",
      "label": "Swiper only mobile",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "hide_product_description",
      "label": "Hide product description"
    },
    {
      "type": "header",
      "content": "Color"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Button color"
    }
  ],
  "blocks": [
    {
      "type": "product-item",
      "name": "Product item",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Product"
        },
        {
          "type": "range",
          "id": "product_rating",
          "label": "Rating",
          "min": 0,
          "max": 5,
          "step": 1,
          "default": 5
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product list"
    }
  ]
}
{% endschema %}